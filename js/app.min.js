var map,geocoder,marker,infowindow,Model=[{title:"Joey's House of Pizza",location:{lat:36.14406,lng:-86.742024},category:"Pizza",iconType:'<span class="map-icon map-icon-restaurant"></span>'},{title:"Fox's Donut Den",location:{lat:36.105782,lng:-86.813194},category:"Donut",iconType:'<span class="map-icon map-icon-restaurant"></span>'},{title:"Shipley Do-Nuts",location:{lat:36.17008,lng:-86.67641},category:"Donut",iconType:'<span class="map-icon map-icon-restaurant"></span>'},{title:"Taco Mamacita",location:{lat:36.142692,lng:-86.791665},category:"Taco",iconType:'<span class="map-icon map-icon-restaurant"></span>'},{title:"Mas Tacos",location:{lat:36.184765,lng:-86.754677},category:"Taco",iconType:'<span class="map-icon map-icon-restaurant"></span>'},{title:"Oscar's Taco",location:{lat:36.16296,lng:-86.781326},category:"Taco",iconType:'<span class="map-icon map-icon-restaurant"></span>'},{title:"Woodlands Indian Vegetarian Cuisine ",location:{lat:36.137968,lng:-86.81972},category:"Vegan",iconType:'<span class="map-icon map-icon-restaurant"></span>'},{title:"Sunflower Cafe",location:{lat:36.113291,lng:-86.767839},category:"Vegan",iconType:'<span class="map-icon map-icon-restaurant"></span>'},{title:"Grins Vegetarian Cafe",location:{lat:36.144731,lng:-86.806367},category:"Vegan",iconType:'<span class="map-icon map-icon-restaurant"></span>'},{title:"Five Points Pizza",location:{lat:36.177123,lng:-86.750496},category:"Pizza",iconType:'<span class="map-icon map-icon-restaurant"></span>'},{title:"Manny's House of Pizza",location:{lat:36.164294,lng:-86.780118},category:"Pizza",iconType:'<span class="map-icon map-icon-restaurant"></span>'},{title:"Tavern",location:{lat:36.150869,lng:-86.797062},category:"Brunch",iconType:'<span class="map-icon map-icon-restaurant"></span>'},{title:"The Garden Brunch Cafe",location:{lat:36.172862,lng:-86.793766},category:"Brunch",iconType:'<span class="map-icon map-icon-restaurant"></span>'},{title:"CREMA",location:{lat:36.156915,lng:-86.769731},category:"Coffee",iconType:'<span class="map-icon map-icon-restaurant"></span>'},{title:"Bongo Java",location:{lat:36.132162,lng:-86.795865},category:"Coffee",iconType:'<span class="map-icon map-icon-restaurant"></span>'},{title:"Ugly Mugs Coffee & Tea",location:{lat:36.182201,lng:-86.735499},category:"Coffee",iconType:'<span class="map-icon map-icon-restaurant"></span>'},{title:"Jeni's Splendid Ice Creams",location:{lat:36.126807,lng:-86.789006},category:"Icecreame",iconType:'<span class="map-icon map-icon-restaurant"></span>'},{title:"Pied Piper Creamery",location:{lat:36.176482,lng:-86.7503},category:"Icecreame",iconType:'<span class="map-icon map-icon-restaurant"></span>'},{title:"Bobbie's Dairy Dip",location:{lat:36.151582,lng:-86.851306},category:"Icecreame",iconType:'<span class="map-icon map-icon-restaurant"></span>'},{title:"Supreme Kreme Rolled Icecream",location:{lat:36.127448,lng:-86.777872},category:"Icecreame",iconType:'<span class="map-icon map-icon-restaurant"></span>'},{title:"King Buffet",location:{lat:36.127406,lng:-86.712754},category:"Buffet",iconType:'<span class="map-icon map-icon-restaurant"></span>'},{title:"Aquarium Restaurant",location:{lat:36.205323,lng:-86.693593},category:"Buffet",iconType:'<span class="map-icon map-icon-restaurant"></span>'},{title:"Arnold's Country Kitchen",location:{lat:36.151461,lng:-86.779595},category:"Buffet",iconType:'<span class="map-icon map-icon-restaurant"></span>'}],markers=[];function mapError(){alert("Opps.. Google Map fail to load. Please check your internet connection or try again later.")}function initMap(){map=new google.maps.Map(document.getElementById("map"),{center:{lat:36.162664,lng:-86.781602},zoom:12,mapTypeControl:!1,disableDefaultUI:!0,gestureHandling:"cooperative",styles:[{elementType:"geometry",stylers:[{color:"#ebe3cd"}]},{featureType:"poi",elementType:"geometry",stylers:[{color:"#dfd2ae"}]},{featureType:"poi",elementType:"labels.text.fill",stylers:[{color:"#7A6A66"}]},{featureType:"poi.park",elementType:"geometry.fill",stylers:[{color:"#69BF46"}]},{featureType:"poi.park",elementType:"labels.text.fill",stylers:[{color:"#447530"}]},{featureType:"road",elementType:"geometry",stylers:[{color:"#f5f1e6"}]},{featureType:"road",elementType:"geometry.fill",stylers:[{color:"#fa982c"}]},{featureType:"road.arterial",elementType:"geometry",stylers:[{color:"#fdfcf8"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{color:"#f8c967"}]},{featureType:"road.highway",elementType:"geometry.fill",stylers:[{weight:4}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{color:"#e9bc62"}]},{featureType:"road.highway.controlled_access",elementType:"geometry",stylers:[{color:"#e98d58"}]},{featureType:"road.highway.controlled_access",elementType:"geometry.stroke",stylers:[{color:"#e1984f"}]},{featureType:"road.local",elementType:"labels.text.fill",stylers:[{color:"#362D2A"}]},{featureType:"water",elementType:"geometry.fill",stylers:[{color:"#04bdfb"}]},{featureType:"water",elementType:"labels.text.fill",stylers:[{color:"#92998d"}]}]}),ko.applyBindings(new ViewModel)}var ViewModel=function(){var e=this;function a(e,a,t){this.id=ko.observable(e),this.Name=ko.observable(a),this.image=ko.observable(t),this.Selected=ko.observable(!1)}e.markerArray=ko.observableArray(),e.filter=ko.observable(""),e.showLists=ko.observable(!1),e.popupList=ko.observable(!1),e.arrow=ko.observable("img/right-arrow.png"),e.highlightMarker=ko.observable(!1),e.filter=ko.observable(""),e.filter_option=ko.observableArray(),e.filters=ko.observableArray(["Donut","Vegan","Pizza","Taco","Brunch","Coffee","Buffet","Icecreame"]),e.init=(e.filter_option.push(new a("donut","Donut","img/donut.png")),e.filter_option.push(new a("vegan","Vegan","img/vegan.png")),e.filter_option.push(new a("pizza","Pizza","img/pizza.png")),e.filter_option.push(new a("taco","Taco","img/taco.png")),e.filter_option.push(new a("brunch","Brunch","img/brunch.png")),e.filter_option.push(new a("coffee","Coffee","img/coffee.png")),e.filter_option.push(new a("buffet","Buffet","img/buffet.png")),void e.filter_option.push(new a("icecreame","Icecreame","img/icecreame.png")));var t=new google.maps.LatLngBounds,o=new google.maps.InfoWindow({maxWidth:120}),n={url:"img/marker.svg",scaledSize:new google.maps.Size(30,50)},r={url:"img/highlightedMarker.svg",scaledSize:new google.maps.Size(30,50)};Model.forEach(function(a){var r,i;r=a,i=new google.maps.Marker({map:map,title:r.title,position:r.location,category:r.category,icon:n}),map.fitBounds(t),e.markerArray().push(i),i.addListener("click",function(){map.setCenter(this.getPosition()),e.populateInfoWindow(this,o),o.open(map,this),e.toggleMarker(i)}),t.extend(i.position)}),e.populateInfoWindow=function(a,t){if(t.marker!=a){t.setContent("Loading..."),t.marker=a;this.htmlContent="<div><h4>"+a.title+"</h4>",$.getJSON("https://api.foursquare.com/v2/venues/search?near=nashville,tn&client_id=SYWGR4EL3JFALWCCKHS1KKUTXT3F4OAIINPODW2RXUXREF1Z&client_secret=5UNHNCDD0PL052SRJ4RLHY4MSXURU1FVDZBTBSUN3EJ5IOAI&v=20180311").done(function(a){var o=a.response.venues[0];e.street=o.location.formattedAddress[0],e.city=o.location.formattedAddress[1],e.htmlContentFoursquare="<h5></h5><div><p>"+e.street+"</p><p>"+e.city+"</p></div> </div>",t.setContent(e.htmlContent+e.htmlContentFoursquare)}).fail(function(){alert("Unable get foursquare data for this location")}),t.open(map,a),t.addListener("closeclick",function(){map.setCenter(new google.maps.LatLng(36.162664,-86.781602)),setTimeout(function(){a.setAnimation(null)},100),t.marker=null,a.setIcon(n)})}},e.visiblePlaces=ko.computed(function(){var a=e.filter().toLowerCase();return ko.utils.arrayFilter(e.markerArray(),function(t){return e.filters().indexOf(t.category)>-1&&t.title.toLowerCase().indexOf(a)>=0?(t.setMap(map),!0):(t.setMap(null),o.close(map,t),!1)})},e),e.toggleMarker=function(e){e.setAnimation(google.maps.Animation.BOUNCE),e.setIcon(r),setTimeout(function(){e.setAnimation(null),e.setIcon(n)},3e3)},e.markerInfo=function(a){e.populateInfoWindow(a,o),map.setCenter(a.getPosition()),e.toggleMarker(a)},e.showList=function(){e.showLists(!e.showLists()),e.showLists()?e.arrow("img/left-arrow.png"):e.arrow("img/right-arrow.png")},ko.bindingHandlers.fadeVisible={init:function(e,a){var t=a();$(e).toggle(ko.unwrap(t))},update:function(e,a){var t=a();ko.unwrap(t)?$(e).fadeIn():$(e).fadeOut()}}};
